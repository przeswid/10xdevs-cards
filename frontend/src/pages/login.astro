---
import Layout from '@/layouts/Layout.astro';
import { checkAuth } from '@/lib/server/auth';
import { LoginFormWrapper } from '@/components/auth/LoginFormWrapper';

// Check if user is already authenticated
const authResult = checkAuth(Astro.cookies, Astro.request);
if (authResult.isAuthenticated) {
  return Astro.redirect('/generate');
}

// Get redirect URL from query params
const redirectTo = Astro.url.searchParams.get('redirect') || '/generate';
---

<Layout title="Login - 10x Cards" showNavigation={false}>
  <div class="min-h-screen flex flex-col items-center justify-center p-4 bg-background">
    <div class="w-full max-w-md space-y-8">
      <div class="text-center">
        <h1 class="text-3xl font-bold tracking-tight">Welcome back</h1>
        <p class="mt-2 text-muted-foreground">
          Log in to your account to continue
        </p>
      </div>

      <LoginFormWrapper client:only="react" redirectTo={redirectTo} />
    </div>
  </div>
</Layout>
